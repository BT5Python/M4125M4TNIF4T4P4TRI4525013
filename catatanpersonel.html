<script>
let namaPersonel = "";

// ------------------------------
// 1. Ambil nama dari URL
// ------------------------------
function getNamaFromURL() {
    const params = new URLSearchParams(window.location.search);
    return params.get("nama") || "";
}

// ------------------------------
// 2. Load catatan dari Web App
// ------------------------------
function loadCatatan() {
    namaPersonel = getNamaFromURL();
    document.getElementById("judul").innerText = "CATATAN: " + namaPersonel;

    fetch("https://script.google.com/macros/s/AKfycbxGzc0W3bcNlLZXRrICQvTtnUNR_hI1QUG0-T7Al0w0w8lCCq32EhLs3XczharOoOZf/exec?nama=" + encodeURIComponent(namaPersonel))
        .then(res => res.text())
        .then(text => {
            document.getElementById("catatan").value = text;
        })
        .catch(err => {
            alert("Gagal mengambil catatan.");
            console.log(err);
        });
}

// ------------------------------
// 3. Simpan catatan ke Web App
// ------------------------------
function simpanCatatan() {
    const isi = document.getElementById("catatan").value;

    fetch("https://script.google.com/macros/s/AKfycbxGzc0W3bcNlLZXRrICQvTtnUNR_hI1QUG0-T7Al0w0w8lCCq32EhLs3XczharOoOZf/exec", {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body:
            "nama=" + encodeURIComponent(namaPersonel) +
            "&catatan=" + encodeURIComponent(isi)
    })
    .then(res => res.text())
    .then(msg => {
        alert("Catatan berhasil disimpan!");
    })
    .catch(err => {
        alert("Gagal menyimpan.");
        console.log(err);
    });
}
</script>
